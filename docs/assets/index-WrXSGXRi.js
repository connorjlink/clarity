var M=Object.defineProperty;var N=(t,l,e)=>l in t?M(t,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[l]=e;var c=(t,l,e)=>N(t,typeof l!="symbol"?l+"":l,e);(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();class $ extends HTMLElement{constructor(){super();c(this,"_messages",[]);c(this,"_visible",!0);c(this,"_endRef",null)}static get observedAttributes(){return["visible"]}get messages(){return this._messages}set messages(e){this._messages=e,this.render(),this.scrollToEnd()}get visible(){return this._visible}set visible(e){this._visible=e,this.render()}scrollToEnd(){this._endRef&&this._endRef.scrollIntoView({behavior:"smooth"})}attributeChangedCallback(e,r,s){e==="visible"&&(this.visible=s!=="false")}connectedCallback(){this.render()}render(){this.innerHTML=`
            <div class="console${this.visible?"":" fade-out"}">
                ${this._messages.map(e=>`<div class="console-line">${e.text}</div>`).join("")}
                <div id="end"></div>
            </div>
        `,this._endRef=this.querySelector("#end"),this.scrollToEnd()}}customElements.define("output-window",$);class D{constructor(l){c(this,"original");c(this,"addBuffer");c(this,"pieces");this.original=l,this.addBuffer="",this.pieces=[{buffer:"original",start:0,length:l.length}]}insert(l,e){if(e.length===0)return;const r=this.addBuffer.length;this.addBuffer+=e;let s=0,i=0;for(;i<this.pieces.length;i++){const h=this.pieces[i];if(s+h.length>=l)break;s+=h.length}if(i===this.pieces.length){this.pieces.push({buffer:"add",start:r,length:e.length});return}const n=this.pieces[i],a=l-s,o=[];a>0&&o.push({buffer:n.buffer,start:n.start,length:a}),o.push({buffer:"add",start:r,length:e.length}),a<n.length&&o.push({buffer:n.buffer,start:n.start+a,length:n.length-a}),this.pieces.splice(i,1,...o)}delete(l,e){let r=0,s=0;for(;s<this.pieces.length&&r+this.pieces[s].length<=l;)r+=this.pieces[s].length,s++;const i=s,n=l-r;let a=e;const o=[];for(;a>0&&s<this.pieces.length;){const h=this.pieces[s],d=s===i?n:0,u=h.length-d;Math.max(0,h.length-u),d>0&&o.push({buffer:h.buffer,start:h.start,length:d}),u<h.length&&o.push({buffer:h.buffer,start:h.start+d+a,length:h.length-(d+a)}),a-=u,s++}this.pieces.splice(i,s-i,...o)}getText(){let l="";for(const e of this.pieces){const r=e.buffer==="original"?this.original:this.addBuffer;l+=r.substr(e.start,e.length)}return l}}var _;(t=>{t.Error=1,t.Warning=2,t.Info=3,t.Log=4,t.Debug=5})(_||(_={}));var w;(t=>{t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(w||(w={}));var x;(t=>{t.None=0,t.Full=1,t.Incremental=2})(x||(x={}));var T;(t=>{t.Text=1,t.Read=2,t.Write=3})(T||(T={}));var C;(t=>{t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(C||(C={}));var k;(t=>{t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(k||(k={}));function b(t){let l="";return t.childNodes.forEach((e,r,s)=>{e.nodeType===Node.TEXT_NODE?l+=e.data:e.tagName==="BR"?l+=`
`:e.tagName==="DIV"?(l+=b(e),r<s.length-1&&(l+=`
`)):e.nodeType===Node.ELEMENT_NODE&&(l+=b(e))}),l}function O(t){let l=0;const e=window.getSelection();if(e&&e.rangeCount>0){const r=e.getRangeAt(0),s=r.cloneRange();s.selectNodeContents(t),s.setEnd(r.endContainer,r.endOffset),l=s.toString().length}return l}function S(t,l){const e=window.getSelection();if(!e)return;let r=0,s=[t],i,n=!1;for(;s.length&&!n&&(i=s.pop(),!!i);)if(i.nodeType===Node.TEXT_NODE){const a=i.length;if(r+a>=l){const o=document.createRange();o.setStart(i,l-r),o.collapse(!0),e.removeAllRanges(),e.addRange(o),n=!0}else r+=a}else{let a=Array.from(i.childNodes);for(let o=a.length-1;o>=0;o--)s.push(a[o])}}class P extends HTMLElement{constructor(){super();c(this,"_pieceTable");c(this,"_consoleListener",null);c(this,"_inputRef",null);c(this,"_highlightRef",null);c(this,"_sourceUri","");c(this,"_lastText","");c(this,"_client",null);c(this,"_hasInitialized",!1);c(this,"_boundInputCallback",this.inputCallback.bind(this));c(this,"_boundScrollCallback",this.scrollCallback.bind(this));c(this,"_boundKeydownCallback",this.keydownCallback.bind(this));this._pieceTable=new D("function nvr main = () {}")}connectedCallback(){}disconnectedCallback(){var e;(e=this._client)==null||e.postMessage({type:"execute",method:"closeDocument",params:{uri:this._sourceUri}})}initialize(e,r,s){var i;this._hasInitialized=!0,this._consoleListener||(this._consoleListener=r),s&&(this._client=s,this._client.addEventListener("message",n=>{var a,o,h;n.data.type==="log"?(a=this._consoleListener)==null||a.notify(n.data.message):n.data.type==="error"?(o=this._consoleListener)==null||o.notify(n.data.message):n.data.type==="compileResult"&&((h=this._consoleListener)==null||h.notify(JSON.stringify(n.data.result)))}),this._client.addEventListener("messageerror",n=>{var a;(a=this._consoleListener)==null||a.notify(n.data)}),this._sourceUri=e),(i=this._client)==null||i.postMessage({type:"execute",method:"openDocument",params:{uri:this._sourceUri,sourceCode:this._pieceTable.getText()}}),this.render()}inputCallback(e){this.handleInputChange(e)}scrollCallback(e){this.syncScroll()}keydownCallback(e){this.handleKeyDown(e)}attachEventListeners(){var e,r,s;(e=this._inputRef)==null||e.addEventListener("input",this._boundInputCallback),(r=this._inputRef)==null||r.addEventListener("scroll",this._boundScrollCallback),(s=this._inputRef)==null||s.addEventListener("keydown",this._boundKeydownCallback)}detachEventListeners(){var e,r,s;(e=this._inputRef)==null||e.removeEventListener("input",this._boundInputCallback),(r=this._inputRef)==null||r.removeEventListener("scroll",this._boundScrollCallback),(s=this._inputRef)==null||s.removeEventListener("keydown",this._boundKeydownCallback)}handleInputChange(e){if(!this._inputRef)return;const r=b(this._inputRef),s=O(this._inputRef);let i=0;for(;i<this._lastText.length&&i<r.length&&this._lastText[i]===r[i];)i++;let n=this._lastText.length-1,a=r.length-1;for(;n>=i&&a>=i&&this._lastText[n]===r[a];)n--,a--;n>=i&&this._pieceTable.delete(i,n-i+1),a>=i&&this._pieceTable.insert(i,r.slice(i,a+1)),this._lastText=r,this.renderHighlight([]),S(this._inputRef,s)}handleKeyDown(e){e.key==="Tab"&&(e.preventDefault(),document.execCommand("insertText",!1,"    ")),e.key==="Enter"&&(e.preventDefault(),document.execCommand("insertLineBreak"))}renderHighlight(e){var r;this._highlightRef&&(this._pieceTable.getText(),(r=this._client)==null||r.postMessage({type:"execute",method:"recycle",params:{uri:this._sourceUri,deltas:e}}))}syncScroll(){this._inputRef&&this._highlightRef&&(this._highlightRef.scrollTop=this._inputRef.scrollTop,this._highlightRef.scrollLeft=this._inputRef.scrollLeft)}render(){if(!this._hasInitialized)throw new Error("call initialize() on SourceEditorElement before rendering.");const e=this._pieceTable.getText();this.innerHTML=`
            <div class="editor-shell">
                <pre class="highlight-layer"></pre>
                <div class="input-layer" contenteditable="true" spellcheck="false"></div>
            </div>
        `,this._highlightRef=this.querySelector(".highlight-layer"),this._inputRef=this.querySelector(".input-layer"),this._inputRef&&(this._inputRef.textContent=e,this._lastText=e),this.attachEventListeners(),this.renderHighlight([])}}customElements.define("source-editor",P);class H extends HTMLElement{constructor(){super(...arguments);c(this,"tabsContent");c(this,"pages",[])}connectedCallback(){this.render(),window.addEventListener("popstate",r=>{var i;const s=((i=r.state)==null?void 0:i.tab)??this.getTabIndexFromUrl();typeof s=="number"&&s>=0&&s<this.pages.length&&this.activatePage(s,!1)});const e=this.getTabIndexFromUrl();typeof e=="number"&&e>=0&&e<this.pages.length&&this.activatePage(e,!1)}getTabIndexFromUrl(){let e=window.location.pathname.replace(/^\//,"");e.startsWith("clarity/")&&(e=e.substring(8));const r=Array.from(this.querySelectorAll("my-tab"));for(let s=0;s<r.length;s++)if(r[s].getAttribute("route")===e)return s;return 0}activatePage(e,r=!0){if(this.pages.forEach((s,i)=>{const n=this.tabsContent.querySelectorAll("input"),a=i===e;s.classList.toggle("active",a),n[i]&&(n[i].checked=a)}),r){const i=Array.from(this.querySelectorAll("my-tab"))[e].getAttribute("route")||"",a=`${window.location.origin}/clarity/${i}`;history.pushState({tab:e},"",a)}}render(){const e=this.querySelector("my-header");if(e){const i=e.children[0];if(i){let n=document.createElement("div");n.className="tabs-bar",i.classList.add("tabs-header"),n.appendChild(i),this.prepend(n)}e.remove()}this.tabsContent=document.createElement("div"),this.tabsContent.className="tabs-content";const r=this.querySelector(".tabs-bar");r?r.append(this.tabsContent):this.prepend(this.tabsContent),Array.from(this.querySelectorAll("my-tab")).forEach((i,n)=>{const a=i.getAttribute("label")||`Tab ${n+1}`,o=`tab-${n}`,h=`tabpanel-${n}`,d=document.createElement("input");d.type="radio",d.id=o,d.checked=n===0,d.addEventListener("change",()=>this.activatePage(n,!0));const u=document.createElement("label");u.htmlFor=o,u.textContent=a;const f=document.createElement("span");f.className="tab-radio-wrapper",f.appendChild(d),f.appendChild(u),this.tabsContent.appendChild(f),i.classList.add("page"),i.setAttribute("id",h),n===0&&i.classList.add("active"),this.pages.push(i)})}}customElements.define("my-tabview",H);class z extends HTMLElement{}customElements.define("my-tab",z);class q extends HTMLElement{}customElements.define("my-header",q);class B extends HTMLElement{constructor(){super()}connectedCallback(){this.render()}render(){const l=document.createElement("div");l.className="article-list";const e=this.querySelectorAll("my-article");for(let r=0;r<e.length;r++){const s=e[r],i=s.getAttribute("article-title")||"",n=s.getAttribute("article-route")||"#",a=s.getAttribute("article-description")||"",o=document.createElement("div");o.className="article-item shadowed hoverable",o.addEventListener("click",()=>{window.location.hash=n});const h=document.createElement("div"),d=document.createElement("h3");d.textContent=i,d.className="article-title";const u=document.createElement("p");u.textContent=a,u.className="article-desc",h.appendChild(d),h.appendChild(u);const f=this.querySelector("custom-icon");f&&o.prepend(f),o.appendChild(h),l.appendChild(o)}this.innerHTML="",this.appendChild(l)}}class F extends HTMLElement{}customElements.define("my-articleselector",B);customElements.define("my-article",F);class U extends HTMLElement{connectedCallback(){this.render()}render(){const l=this.getAttribute("text")||"Hz",e=this.getAttribute("size")||"300",r=this.getAttribute("radius"),s=r?`border-radius: ${r};`:"",i=this.getAttribute("shadow-color")||"var(--haze-color-shadow)",n=this.getAttribute("foreground-top-color")||"var(--haze-color-foreground-top)",a=this.getAttribute("foreground-bottom-color")||"var(--haze-color-foreground-bottom)",o=this.getAttribute("background-top-color")||"var(--haze-color-background-top)",h=this.getAttribute("background-bottom-color")||"var(--haze-color-background-bottom)",d=(Math.random()+1).toString(36).substring(7),u=`bgGradient-${d}`,f=`highlight-${d}`,v=`textGradient-${d}`,y=`dropShadow-${d}`;this.innerHTML=`
            <svg class="custom-icon" style="${s}" width="${e}" height="${e}" viewBox="0 0 300 300" xmlns="http://www.w3.org/2000/svg">
            	<defs>
            		<linearGradient id="${u}" x1="0%" y1="0%" x2="0%" y2="100%">
            			<stop offset="0%" stop-color="${o}" />
            			<stop offset="100%" stop-color="${h}" />
            		</linearGradient>

            		<linearGradient id="${v}" x1="0%" y1="0%" x2="0%" y2="100%">
            			<stop offset="0%" stop-color="${n}" />
            			<stop offset="100%" stop-color="${a}" />
            		</linearGradient>

            		<linearGradient id="highlight" x1="0%" y1="0%" x2="100%" y2="100%">
            			<stop offset="0%" stop-color="white" stop-opacity="0" />
            			<stop offset="100%" stop-color="white" stop-opacity="0.4" />
            		</linearGradient>

            		<filter id="${y}" x="-20%" y="-20%" width="140%" height="140%">
            			<feDropShadow dx="5" dy="5" stdDeviation="10" flood-color="rgba(0,0,0,0.5)" />
            		</filter>
            	</defs>

            	<g>
            		<rect x="0" y="0" width="300" height="300" fill="url(#${u})" />
            		<rect x="0" y="0" width="300" height="300" fill="url(#${f})" />
            	</g>

            	<text x="155" y="170" text-anchor="middle" dominant-baseline="middle"
            		  font-size="180"
            		  fill="${i}" opacity="1.0">
            		${l}
            	</text>

            	<text x="150" y="165" text-anchor="middle" dominant-baseline="middle"
            		  font-size="180"
            		  fill="url(#${v})" filter="url(#${y})"
            		  stroke="rgba(255,255,255,0.3)" stroke-width="1">
            		${l}
            	</text>
            </svg>
        `}}customElements.define("custom-icon",U);class W extends HTMLElement{constructor(){super();c(this,"isExpanded",!1);c(this,"headerDivElement",null);c(this,"caretSpanElement",null);c(this,"contentDivElement",null)}static get observedAttributes(){return["header"]}connectedCallback(){if(this.querySelector(".my-collapsible-header"))return;this.headerDivElement=document.createElement("div"),this.headerDivElement.className="my-collapsible-header",this.headerDivElement.tabIndex=0,this.caretSpanElement=document.createElement("span"),this.caretSpanElement.className="my-collapsible-caret",this.caretSpanElement.innerHTML=`
            <svg viewBox="0 0 16 16" fill="none" width="16" height="16">
                <path d="M5 6l3 3 3-3" stroke="#aaa" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        `;const e=document.createElement("span");for(e.className="my-collapsible-header-text",e.textContent=this.getAttribute("header")||"",this.headerDivElement.appendChild(this.caretSpanElement),this.headerDivElement.appendChild(e),this.contentDivElement=document.createElement("div"),this.contentDivElement.className="my-collapsible-content";this.firstChild&&(this.firstChild!==this.headerDivElement&&this.firstChild!==this.contentDivElement);)this.contentDivElement.appendChild(this.firstChild);this.appendChild(this.headerDivElement),this.appendChild(this.contentDivElement),this.headerDivElement.addEventListener("click",()=>this.toggle()),this.headerDivElement.addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),this.toggle())})}attributeChangedCallback(e,r,s){if(e==="header"&&this.headerDivElement){const i=this.headerDivElement.querySelector(".my-collapsible-header-text");i&&(i.textContent=s||"")}}toggle(){this.isExpanded=!this.isExpanded,this.isExpanded?this.setAttribute("expanded",""):this.removeAttribute("expanded")}}customElements.define("my-collapsible",W);const p=document.getElementById("output-window");p.messages=[];p.visible=!1;var g;const G=()=>{p.visible=!0,g&&clearTimeout(g.current),g=setTimeout(()=>p.visible=!1,1e4)},V={notify:t=>{console.log(t),p.messages=[...p.messages,{id:Date.now().toString(),text:t,visible:!0}],G()}},I=new Worker(new URL("/clarity/assets/language_server_worker-BOXhEwlU.js",import.meta.url),{type:"module"}),L=new Worker(new URL("/clarity/assets/language_client_worker-2arvf2PA.js",import.meta.url),{type:"module"}),R=new MessageChannel,m=R.port1,E=R.port2;I.postMessage({type:"connect",port:m},[m]);L.postMessage({type:"connect",port:E},[E]);m.start();E.start();const A=document.querySelector("#main-editor");A.attachEventListeners();A.initialize("file:///c:/Users/Connor/Desktop/clarity/src/index.ts",V,L);
